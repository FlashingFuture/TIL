# SQL 기본

## Data Control Language

DCL: 데이터베이스에 접근하고 객체들을 사용하도록 권한을 주고 회수하는 명령어

```sql
SELECT [ALL/DISTINCT] 컬럼명, 컬럼명, ...
FROM 테이블명;
```

- ALL: Default 옵션, 중복된 데이터가 있어도 모두 출력
- DISTINCT: 중복된 데이터가 있는 경우 1건으로 처리하여 출력

```sql
WHERE 컬럼명 비교연산자 [문자/숫자/표현식] 비교컬럼명(JOIN 사용 시)
```

- NULL 값과의 연산은 NULL을 리턴
- NULL 값과의 비교연산은 거짓(FALSE) 리턴

| 연산자 종류      | 연산자           | 설명                                   |
| ---------------- | ---------------- | -------------------------------------- |
| 비교 연산자      | =                | 두 값이 같으면 참                      |
| 비교 연산자      | !=               | 두 값이 다르면 참                      |
| 비교 연산자      | >                | 왼쪽 값이 크면 참                      |
| 비교 연산자      | <                | 왼쪽 값이 작으면 참                    |
| 비교 연산자      | >=               | 왼쪽 값이 크거나 같으면 참             |
| 비교 연산자      | <=               | 왼쪽 값이 작거나 같으면 참             |
| SQL 연산자       | BETWEEN          | 특정 범위 내에 값이 포함되면 참        |
| SQL 연산자       | IN               | 특정 목록 내에 값이 포함되면 참        |
| SQL 연산자       | LIKE             | 비교 문자열과 일치하면 참              |
| 논리 연산자      | AND              | 두 조건이 모두 참이면 참               |
| 논리 연산자      | OR               | 두 조건 중 하나라도 참이면 참          |
| 논리 연산자      | NOT              | 조건이 거짓이면 참                     |
| 부정 비교 연산자 | != (<>, ^= 동일) | 두 값이 다르면 참                      |
| 부정 비교 연산자 | IS NOT NULL      | NULL이 아닌 값을 가지면 참             |
| 부정 SQL 연산자  | NOT IN           | 특정 목록 내에 값이 포함되지 않으면 참 |
| 부정 SQL 연산자  | NOT LIKE         | 특정 패턴과 일치하지 않으면 참         |

### GROUP BY 절과 HAVING 절의 특성

- GROUP BY 절을 통해 소그룹별 기준을 정한 후 SELECT 절에 집계 함수 사용
- 집계 함수의 통계 정보는 NULL 값을 가진 행을 제외하고 수행
- GROUP BY 절에서는 SELECT 절과 달리 ALIAS 명을 사용할 수 없음
- 집계 함수는 WHERE 절에 올 수 없음(GROUP BY 절보다 WHERE 절이 먼저 수행됨)
- WHERE 절은 GROUP으로 나누기 전에 행들을 미리 제거함
- HAVING 절을 통해 GROUP By 절의 기준 항목이나 소그룹 집계 함수를 이용한 조건을 표시할 수 있음

## DUAL 테이블의 특성

DUAL 테이블: Oracle에서 제공하는 단순 연산, 함수 테스트, 상수 반환 등에 사용되는 가상 테이블

- 단일 행과 단일 열로 구성됨
- 사용자 SYS가 소유하며 모든 사용자가 액세스 가능한 테이블
- SELECT ~ FROM ~ 의 형식을 갖추기 위한 DUMMY 테이블
- DUMMY라는 문자열 유형의 컬럼에 'X'라는 값이 들어 있는 행을 1건 포함

| 함수 종류 | 함수명                            | 설명                                       |
| --------- | --------------------------------- | ------------------------------------------ |
| 문자 함수 | UPPER(str)                        | 문자열을 대문자로 변환                     |
| 문자 함수 | LOWER(str)                        | 문자열을 소문자로 변환                     |
| 문자 함수 | INITCAP(str)                      | 문자열의 첫 글자를 대문자로 변환           |
| 문자 함수 | LENGTH(str) / LEN                 | 문자열의 길이를 반환                       |
| 문자 함수 | SUBSTR(str, s, n) / SUBSTRING     | 문자열에서 s번째 위치부터 n개 문자 추출    |
| 문자 함수 | CONCAT(str1, str2)                | 두 문자열을 연결                           |
| 문자 함수 | TRIM(str)                         | 문자열의 앞뒤 공백 제거                    |
| 문자 함수 | REPLACE(str, old, new)            | 특정 문자열을 다른 문자열로 치환           |
| 숫자 함수 | ROUND(num, n)                     | 소수점 n자리까지 반올림                    |
| 숫자 함수 | TRUNC(num, n)                     | 소수점 n자리까지 버림                      |
| 숫자 함수 | CEIL(num)                         | 주어진 숫자보다 크거나 같은 최소 정수 반환 |
| 숫자 함수 | FLOOR(num)                        | 주어진 숫자보다 작거나 같은 최대 정수 반환 |
| 숫자 함수 | ABS(num)                          | 절대값 반환                                |
| 숫자 함수 | MOD(a, b)                         | a를 b로 나눈 나머지 반환                   |
| 날짜 함수 | SYSDATE                           | 현재 시스템 날짜 반환                      |
| 날짜 함수 | CURRENT_DATE                      | 현재 세션의 날짜 반환                      |
| 날짜 함수 | ADD_MONTHS(date, n)               | 특정 날짜에 n개월 추가                     |
| 날짜 함수 | MONTHS_BETWEEN(date1, date2)      | 두 날짜 간 개월 수 반환                    |
| 날짜 함수 | NEXT_DAY(date, '요일')            | 특정 날짜의 다음 해당 요일 반환            |
| 변환 함수 | TO_CHAR(value, format)            | 숫자 또는 날짜를 문자형으로 변환           |
| 변환 함수 | TO_NUMBER(str)                    | 문자열을 숫자로 변환                       |
| 변환 함수 | TO_DATE(str, format)              | 문자열을 날짜형으로 변환                   |
| 일반 함수 | NVL(expr1, expr2)                 | NULL 값을 다른 값으로 대체                 |
| 일반 함수 | NVL2(expr1, expr2, expr3)         | NULL 여부에 따라 다른 값 반환              |
| 일반 함수 | NULLIF(expr1, expr2)              | 두 값이 같으면 NULL, 다르면 expr1 반환     |
| 일반 함수 | COALESCE(expr1, expr2, ...)       | NULL이 아닌 첫 번째 값 반환                |
| 일반 함수 | CASE                              | 조건에 따라 다른 값을 반환                 |
| 일반 함수 | DECODE(expr, search, result, ...) | 특정 값에 대한 매핑 수행                   |

### NULL 관련 함수

- Oracle: NVL(표현식1, 표현식2) 오라클 함ㅁ수 ISNULL(표현식1, 표현식2)
- 함수 NULLIF(표현식1, 표현식2) COALESCE(표현식1, 표현식2, ...)(NULL이 아닌 첫 번째 값을 반환)

## ORDER BY 절 특징

- 기본 정렬 순서는 ASC
- 오라클에서는 NULL 값을 가장 큰 값으로, SQL Server에서는 NULL 값을 가장 작은 값으로 간주

## SELECT문 실행 순서

1. 발췌 대상 테이블 참조(FROM)
2. 발췌 대상 데이터가 아닌 것을 제거(WHERE)
3. 행들을 소그룹화(GROUP BY)
4. 그루핑된 값의 조건에 맞는 것만을 출력(HAVING)
5. 데이터 출력/계산(SELECT)
6. 데이터 정렬(ORDER BY)

## EQUI JOIN

```SQL
SELECT 테이블1.컬럼명, 테이블2.컬럼명
FROM 테이블1, 테이블2
WHERE 테이블1.컬럼명 = 테이블2.컬럼명;

SELECT 테이블1.컬럼명, 테이블2.컬럼명
FROM 테이블1 INNER JOIN 테이블2
ON 테이블1.컬럼명 = 테이블2.컬럼명;
```

## JOIN

- INNER JOIN은 JOIN 조건에서 동일한 값이 있는 행만 반환
- CROSS JOIN은 테이블 간 JOIN 조건이 없는 경우 생길 수 있는 모든 데이터의 조합으로 M \* N 건의 데이터 조합이 발생
- LEFT OUTER JOIN은 왼쪽 테이블의 모든 행을 포함하면서 오른쪽 테이블에 일치하는 값이 없는 컬럼에 대해 NULL을 반환
- RIGHT OUTER JOIN은 오른쪽 테이블의 모든 행을 포함하면서 왼쪽 테이블에 일치하는 값이 없는 컬럼에 대해 NULL을 반환
- FULL OUTER JOIN은 두 테이블에서 일치하는 모든 행을 포함하며 어느 한 쪽에 일치하는 값이 없다면 NULL을 반환

# SQL 활용
